# Introduction

This repository has a series of neural networks that aim to model temporal relations in egocentric action videos.

1. TRN : Temporal Relation Network used to model the relations between frames
2. Average Pooling : Simple method for temporally aggregate data
3. Transformer Aggregator : Implementation with a transformer of a temporal aggregation method, combined with average pooling.

The project is divided in the below described folders containing models, scripts. The main script to be called is
train_model.py

# Environment

It is necessary to have a python environment with the requirements in **requirements.txt** (Python version 3.10.4)

`$python pip install -r requirements.txt`
# Script and Models
The main script to be called is the script train_model.py . It receives arguments specified in the args.py script inside the utils folder.




The folder models contains the models used for the experiments.

1. TRNmodule : Temporal Relation Module taken from the original paper. It already has a classifier implemented.
2. AvgClassifier : Classifier implementing an average pooling along the temporal dimension.
3. AttentionBaselineClassifier : Classifier with the self-attention mechanism provided by the transformer
4. MultiHeadAttention : Series of classifiers using PyTorch implementation of transformer and explicitly coded transformer.
# Scripts and Testing
Before running any test it is necessary to set-up the paths inside the module utils/feature_loaders.py.

In this folder we find the scripts for running the tests. Those scripts must be called from the base folder as in
the following example.

`$./Scripts/train_aggregators.sh`

In this folder there is:

1. train_aggregators : Script testing i3d and TSM with their respective temporal aggregation for both modalities (RGB,Flow)
2. self_attention.sh : Script testing the temporal aggregation with the transformer.

---

Parameters to call the train_model.py are:

- temporal_aggregator : It is the temporal aggregator to use. CHeck available temporal aggregators in the train_model.py module in the instantiateModels function.
- epochs : Number of epochs
- verbose : Extra output with information
- learning_rate : The learning rate to use in training
- batch_size : The batch size to use
- model : Base model to use (i3d or TSM)

To directly call the script it is enough to compose a command like the following:


`--verbose --epochs 50 --model TSM --temporal_aggregator MultiAttentionPytorch --shift D3-D3 --modality Flow --transpose_input --batch_size 1000 --learning_rate 0.1 --frequency_validation 50`


# Utils

Folder with python scripts generally useful for running the experiments.

1. args.py : Script containing the arguments for calling the experiment.
2. feature_loaders.py : Module containing the dataset loader. Notice the class inside this script must be modified for running the experiment (to be fixed in the future)
3. process_ressults.py : Module with a class for processing the results generated by the experiment
4. utils.py : General functions grouped together (file handling, accuracy computation).

